<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <style>
        .btn-custom {
          background-color: #744321; /* Marrom café */
          border-color: #744321;
          color: #f5f5dc;
        }
    </style>

</head>
<body style="background-color: #63320d;"> 

<section class="vh-100 d-flex justify-content-center align-items-center">
  <div class="container">
    <div class="row d-flex justify-content-center">
      <div class="col-md-12 col-lg-9"> 
        <div class="card p-4" style="border-radius: 1rem;">
          <div class="card-body text-black">

            <h1 class="fw-bold text-center mb-4">Cadastro</h1>

            <form>
              <div class="row">
                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label" for="nome">Nome Completo</label>
                  <input type="text" id="nome" class="form-control" placeholder= "Exemplo: Logan Borges " minlength="5" required/>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label" for="email">E-mail</label>
                  <input type="email" id="email" class="form-control" required placeholder="seuemail@gmail.com"  />
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label" for="senha">Senha</label>
                  <div class="input-group">
                    <input type="password" required id="senha" placeholder= "Digite sua senha " class="form-control" pattern="^(?=.*[A-Z])(?=.*\d).{8,}$" 
                           title="Deve conter pelo menos uma letra maiúscula, um número e no mínimo 8 caracteres" />
                           <button class="btn btn-outline-secondary" type="button" id="toggleSenha">
                            <i class="bi bi-eye"></i>
                          </button>
                  </div>
                </div>
      
                

                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label" for="cpf">CPF</label>
                  <input onkeydown="return mascaraCPF(event)" type="text" id="cpf" class="form-control" required placeholder="000.000.000-00" maxlength="14"/>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label" for="telefone">Número de telefone</label>
                  <input onkeydown="return mascaraTelefone(event)" type="tel" id="telefone" class="form-control" placeholder="(xx) xxxx-xxxx" required/>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label" for="data">Data de Nascimento</label>
                  <input type="date" id="data" class="form-control" max=""  required />
                </div>
            
              <div class="d-grid mt-4">
                <button class="btn btn-dark btn-custom" type="submit" id="btnCadastrar">Cadastrar </button>
              </div>

              <p class="mt-3 text-center">
                Já tem uma conta? <a href="login.html" class="text-decoration-none" style="color: #393f81;">Entre aqui</a>
              </p>
            </form>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>

function mascaraTelefone(event) {
  let tecla = event.key;
  // Regex: 
  // g = não termina verificação enquanto não houver combinação para todos os elementos da Regex
  // \D+ = troca qualquer caractere que não seja um dígito por caracter vazio
  let telefone = event.target.value.replace(/\D+/g, "");

  // Regex: i = case insensitive
  // Se Tecla é número, concatena com telefone
  if (/^[0-9]$/i.test(tecla)) {
    telefone = telefone + tecla;
    let tamanho = telefone.length;

    if (tamanho >= 12) { // Se telefone com 12 ou mais caracteres, não faz mais nada
      return false;
    }

    if (tamanho > 10) { 
      telefone = telefone.replace(/^(\d\d)(\d{5})(\d{4}).*/, "($1) $2-$3");
    } else if (tamanho > 5) { 
      telefone = telefone.replace(/^(\d\d)(\d{4})(\d{0,4}).*/, "($1) $2-$3");
    } else if (tamanho > 2) { 
      telefone = telefone.replace(/^(\d\d)(\d{0,5})/, "($1) $2");
    } else {
      telefone = telefone.replace(/^(\d*)/, "($1");
    }

    event.target.value = telefone;
  }

  if (!["Backspace", "Delete", "Tab"].includes(tecla)) {
    return false;
  }
}


function mascaraCPF(event) {
  let tecla = event.key;
  let cpf = event.target.value.replace(/\D+/g, ""); // Remove tudo que não for número

  // Se a tecla for um número, adiciona ao CPF
  if (/^[0-9]$/i.test(tecla)) {
    cpf = cpf + tecla;
    let tamanho = cpf.length;

    if (tamanho >= 12) { // Se CPF tiver mais de 11 dígitos, não faz mais nada
      return false;
    }

    // Aplica a máscara no formato XXX.XXX.XXX-XX
    if (tamanho > 9) {
      cpf = cpf.replace(/^(\d{3})(\d{3})(\d{3})(\d{0,2}).*/, "$1.$2.$3-$4");
    } else if (tamanho > 6) {
      cpf = cpf.replace(/^(\d{3})(\d{3})(\d{0,3})/, "$1.$2.$3");
    } else if (tamanho > 3) {
      cpf = cpf.replace(/^(\d{3})(\d{0,3})/, "$1.$2");
    }

    event.target.value = cpf;
  }

  // Permite apenas backspace, delete e tab
  if (!["Backspace", "Delete", "Tab"].includes(tecla)) {
    return false;
  }
}

// Função para validar CPF
function validarCPF(cpf) {
  if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false; // Verifica se todos os dígitos são iguais ou tamanho inválido

  let soma = 0;
  let resto;

  // Calcula o primeiro dígito verificador
  for (let i = 1; i <= 9; i++) {
    soma += parseInt(cpf.substring(i - 1, i)) * (11 - i);
  }
  resto = (soma * 10) % 11;
  if (resto === 10 || resto === 11) resto = 0;
  if (resto !== parseInt(cpf.substring(9, 10))) return false;

  soma = 0;

  // Calcula o segundo dígito verificador
  for (let i = 1; i <= 10; i++) {
    soma += parseInt(cpf.substring(i - 1, i)) * (12 - i);
  }
  resto = (soma * 10) % 11;
  if (resto === 10 || resto === 11) resto = 0;
  if (resto !== parseInt(cpf.substring(10, 11))) return false;

  return true;
}

document.getElementById('data').setAttribute('max', new Date().toISOString().split('T')[0]);

document.getElementById('toggleSenha').addEventListener('click', function () {
    var senhaInput = document.getElementById('senha');
    var icon = this.querySelector('i');

    if (senhaInput.type === 'password') {
      senhaInput.type = 'text';
      icon.classList.remove('bi-eye');
      icon.classList.add('bi-eye-slash');
    } else {
      senhaInput.type = 'password';
      icon.classList.remove('bi-eye-slash');
      icon.classList.add('bi-eye');
    }
  });

document.getElementById('btnCadastrar').addEventListener('click', function (event) {
  event.preventDefault(); // Previne o envio do formulário

  const cpfInput = document.getElementById('cpf');
  const cpf = cpfInput.value.replace(/\D+/g, ""); // Remove a máscara do CPF

  if (!validarCPF(cpf)) {
    Swal.fire({
      icon: 'error',
      title: 'CPF inválido!',
      text: 'Por favor, insira um CPF válido.',
      confirmButtonColor: '#744321'
    });
    cpfInput.focus(); // Foca no campo de CPF
    return;
  }

  // Se o CPF for válido, exibe mensagem de sucesso
  Swal.fire({
    icon: 'success',
    title: 'Cadastro realizado!',
    text: 'Seu cadastro foi concluído com sucesso.',
    confirmButtonColor: '#744321'
  }).then(() => {
    // Aqui você pode enviar o formulário manualmente, se necessário
    document.querySelector('form').submit();
  });
});

</script>


</body>
</html>
